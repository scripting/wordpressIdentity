<?xml version="1.0" encoding="ISO-8859-1"?>
<!-- OPML generated by OPML Editor v10.1b19 on Tue, 22 Aug 2023 22:29:24 GMT -->

<!-- 
   Hi this is Dave Winer. I write all my project code in an outliner, which 
   generates all the files that make up this GitHub project. You'll see a 
   source.opml file like this in each of my projects. It contains the outline 
   source that the repo files were generated from. This is the most logical place 
   to store them. You can read the code in any outliner that supports OPML, which 
   includes https://drummer.land. You can use the Open URL command in 
   Drummer's File menu to open the "raw" version of this file straight from the 
   GitHub repo.
 -->

<opml version="2.0">
	<head>
		<title>nodeEditor: wordpressIdentity</title>
		<dateCreated>Tue, 22 Aug 2023 14:20:51 GMT</dateCreated>
		<dateModified>Tue, 22 Aug 2023 22:29:24 GMT</dateModified>
		<ownerName>Dave Winer</ownerName>
		<ownerId>http://davewiner.com/</ownerId>
		<expansionState>1, 4, 17, 25, 27, 30, 31, 33, 48, 49, 50, 53, 55, 63, 65, 66, 73</expansionState>
		<vertScrollState>2</vertScrollState>
		<windowTop>215</windowTop>
		<windowLeft>1160</windowLeft>
		<windowBottom>1204</windowBottom>
		<windowRight>2560</windowRight>
		</head>
	<body>
		<outline text="/scripting.com/code/wpidentity/">
			<outline text="worknotes.md" created="Sun, 18 Jun 2023 16:13:00 GMT">
				<outline text="#### 8/22/23; 10:21:35 AM by DW" created="Sat, 12 Aug 2023 22:34:42 GMT">
					<outline text="Started." created="Sat, 12 Aug 2023 22:34:44 GMT"/>
					</outline>
				</outline>
			<outline text="package.json">
				<outline text="{">
					<outline text="&quot;name&quot;: &quot;wpidentity&quot;,"/>
					<outline text="&quot;description&quot;: &quot;Implements OAuth identity with wordpress.com for Node.js apps.&quot;,"/>
					<outline text="&quot;version&quot;: &quot;0.4.0&quot;,"/>
					<outline text="&quot;main&quot;: &quot;wpidentity.js&quot;,"/>
					<outline text="&quot;dependencies&quot; : {">
						<outline text="&quot;request&quot;: &quot;*&quot;,"/>
						<outline text="&quot;daveutils&quot;: &quot;*&quot;,"/>
						<outline text="&quot;davehttp&quot;: &quot;*&quot;" created="Tue, 22 Aug 2023 15:21:53 GMT"/>
						<outline text="}"/>
						</outline>
					<outline text="}"/>
					</outline>
				</outline>
			<outline text="wpidentity.js">
				<outline text="var myProductName = &quot;wpserver&quot;, myVersion = &quot;0.4.0&quot;;"/>
				<outline text="" created="Sat, 12 Aug 2023 22:37:22 GMT"/>
				<outline text="const fs = require (&quot;fs&quot;);" created="Sat, 05 Mar 2022 17:19:07 GMT"/>
				<outline text="const utils = require (&quot;daveutils&quot;); "/>
				<outline text="const request = require (&quot;request&quot;);" created="Sat, 05 Mar 2022 17:19:07 GMT"/>
				<outline text="const davehttp = require (&quot;davehttp&quot;);" created="Sat, 05 Mar 2022 17:19:07 GMT"/>
				<outline text="" created="Tue, 22 Aug 2023 15:11:42 GMT"/>
				<outline text="var config = { ">
					<outline text="port: process.env.PORT || 1408,"/>
					<outline text="flLogToConsole: true,"/>
					<outline text="flAllowAccessFromAnywhere: true, //for davehttp"/>
					<outline text="" created="Tue, 22 Aug 2023 21:45:33 GMT"/>
					<outline text="myRandomNumber: utils.random (1, 1000000000)," created="Tue, 22 Aug 2023 21:45:33 GMT"/>
					<outline text="urlMyHomePage: &quot;http://scripting.com/code/wpidentity/&quot;," created="Tue, 22 Aug 2023 22:13:05 GMT"/>
					<outline text="" created="Tue, 22 Aug 2023 15:32:36 GMT"/>
					<outline text="urlRequestToken: &quot;https://public-api.wordpress.com/oauth2/token&quot;," created="Tue, 22 Aug 2023 15:32:36 GMT"/>
					<outline text="urlAuthorize: &quot;https://public-api.wordpress.com/oauth2/authorize&quot;," created="Tue, 22 Aug 2023 15:32:45 GMT"/>
					<outline text="urlAuthenticate: &quot;https://public-api.wordpress.com/oauth2/authenticate&quot;," created="Tue, 22 Aug 2023 15:33:00 GMT"/>
					<outline text="urlRedirect: &quot;http://localhost:1408/callbackFromWordpress&quot;" created="Tue, 22 Aug 2023 15:35:26 GMT"/>
					<outline text="};"/>
					</outline>
				<outline text="" created="Tue, 22 Aug 2023 15:29:45 GMT"/>
				<outline text="function readConfig (f, config, callback) {" created="Mon, 08 Mar 2021 15:19:44 GMT">
					<outline text="fs.readFile (f, function (err, jsontext) {" created="Mon, 08 Mar 2021 15:19:57 GMT">
						<outline text="if (!err) {" created="Mon, 08 Mar 2021 15:20:27 GMT">
							<outline text="try {" created="Mon, 08 Mar 2021 15:20:49 GMT">
								<outline text="var jstruct = JSON.parse (jsontext);" created="Mon, 08 Mar 2021 15:21:07 GMT"/>
								<outline text="for (var x in jstruct) {" created="Mon, 08 Mar 2021 15:21:14 GMT">
									<outline text="config [x] = jstruct [x];" created="Mon, 08 Mar 2021 15:21:20 GMT"/>
									<outline text="}" created="Mon, 08 Mar 2021 15:21:25 GMT"/>
									</outline>
								<outline text="}" created="Mon, 08 Mar 2021 15:20:58 GMT"/>
								</outline>
							<outline text="catch (err) {" created="Mon, 08 Mar 2021 15:20:59 GMT">
								<outline text="console.log (&quot;Error reading &quot; + f);" created="Mon, 08 Mar 2021 15:20:35 GMT"/>
								<outline text="}" created="Mon, 08 Mar 2021 15:21:03 GMT"/>
								</outline>
							<outline text="}" created="Mon, 08 Mar 2021 15:20:30 GMT"/>
							</outline>
						<outline text="callback ();" created="Mon, 08 Mar 2021 15:22:15 GMT"/>
						<outline text="});" created="Mon, 08 Mar 2021 15:20:25 GMT"/>
						</outline>
					<outline text="}" created="Mon, 08 Mar 2021 15:19:56 GMT"/>
					</outline>
				<outline text="function connectWithWordpress (callback) {" created="Tue, 22 Aug 2023 15:29:45 GMT">
					<outline text="var params = {">
						<outline text="response_type: &quot;code&quot;," created="Tue, 22 Aug 2023 15:33:59 GMT"/>
						<outline text="client_id: config.clientId,"/>
						<outline text="state: config.myRandomNumber," created="Tue, 22 Aug 2023 15:34:15 GMT"/>
						<outline text="redirect_uri: config.urlRedirect" created="Tue, 22 Aug 2023 15:35:04 GMT"/>
						<outline text="};"/>
						</outline>
					<outline text="var apiUrl = config.urlAuthenticate + &quot;?&quot; + utils.buildParamList (params);"/>
					<outline text="request (apiUrl, function (err, response, body) {">
						<outline text="if (err) {">
							<outline text="console.log (&quot;connectWithWordpress: err.message == &quot; + err.message);"/>
							<outline text="callback (err);" created="Mon, 08 Nov 2021 17:33:37 GMT"/>
							<outline text="}"/>
							</outline>
						<outline text="else {">
							<outline text="console.log (&quot;connectWithWordpress: body == &quot; + body);"/>
							<outline text="callback (undefined, body);" created="Mon, 08 Nov 2021 17:38:59 GMT"/>
							<outline text="}"/>
							</outline>
						<outline text="});"/>
						</outline>
					<outline text="}" created="Tue, 22 Aug 2023 15:29:51 GMT"/>
					</outline>
				<outline text="function requestTokenFromWordpress (theCode, callback) {" created="Tue, 22 Aug 2023 16:24:37 GMT">
					<outline text="var params = {" created="Tue, 22 Aug 2023 16:32:41 GMT">
						<outline text="client_id: config.clientId,"/>
						<outline text="client_secret: config.clientSecret,"/>
						<outline text="redirect_uri: config.urlRedirect," created="Tue, 22 Aug 2023 15:35:04 GMT"/>
						<outline text="code: theCode," created="Tue, 22 Aug 2023 16:26:34 GMT"/>
						<outline text="grant_type: &quot;authorization_code&quot;," created="Tue, 22 Aug 2023 15:33:59 GMT"/>
						<outline text="};" created="Tue, 22 Aug 2023 16:32:48 GMT"/>
						</outline>
					<outline text="var theRequest = {">
						<outline text="method: &quot;POST&quot;,"/>
						<outline text="url: config.urlRequestToken + &quot;?&quot; + utils.buildParamList (params)," created="Tue, 22 Aug 2023 16:28:05 GMT"/>
						<outline text="form: {" created="Tue, 22 Aug 2023 16:35:36 GMT">
							<outline text="client_id: config.clientId,"/>
							<outline text="client_secret: config.clientSecret,"/>
							<outline text="redirect_uri: config.urlRedirect," created="Tue, 22 Aug 2023 15:35:04 GMT"/>
							<outline text="code: theCode," created="Tue, 22 Aug 2023 16:26:34 GMT"/>
							<outline text="grant_type: &quot;authorization_code&quot;" created="Tue, 22 Aug 2023 15:33:59 GMT"/>
							<outline text="}" created="Tue, 22 Aug 2023 16:35:47 GMT"/>
							</outline>
						<outline text="};"/>
						</outline>
					<outline text="request (theRequest, function (err, response, body) {">
						<outline text="if (err) {">
							<outline text="callback (err);" created="Mon, 08 Nov 2021 17:33:37 GMT"/>
							<outline text="}"/>
							</outline>
						<outline text="else {">
							<outline text="try {" created="Tue, 22 Aug 2023 16:40:37 GMT">
								<outline text="const data = JSON.parse (body);" created="Tue, 22 Aug 2023 16:40:51 GMT"/>
								<outline text="callback (undefined, data);" created="Tue, 22 Aug 2023 16:41:07 GMT"/>
								<outline text="}" created="Tue, 22 Aug 2023 16:40:40 GMT"/>
								</outline>
							<outline text="catch (err) {" created="Tue, 22 Aug 2023 16:40:41 GMT">
								<outline text="callback (err);" created="Tue, 22 Aug 2023 16:40:45 GMT"/>
								<outline text="}" created="Tue, 22 Aug 2023 16:40:48 GMT"/>
								</outline>
							<outline text="}"/>
							</outline>
						<outline text="});"/>
						</outline>
					<outline text="}" created="Tue, 22 Aug 2023 16:25:05 GMT"/>
					</outline>
				<outline text="function handleHttpRequest (theRequest) {" created="Tue, 22 Aug 2023 21:49:47 GMT">
					<outline text="const params = theRequest.params;" created="Tue, 22 Aug 2023 16:23:04 GMT"/>
					<outline text="function returnRedirect (url, code) { //9/30/20 by DW">
						<outline text="var headers = {">
							<outline text="location: url"/>
							<outline text="};"/>
							</outline>
						<outline text="if (code === undefined) {">
							<outline text="code = 302;"/>
							<outline text="}"/>
							</outline>
						<outline text="theRequest.httpReturn (code, &quot;text/plain&quot;, code + &quot; REDIRECT&quot;, headers);"/>
						<outline text="}"/>
						<outline text=""/>
						</outline>
					<outline text="function returnNotFound () {" created="Mon, 28 Feb 2022 14:38:48 GMT">
						<outline text="theRequest.httpReturn (404, &quot;text/plain&quot;, &quot;Not found.&quot;);"/>
						<outline text="}" created="Mon, 28 Feb 2022 14:38:53 GMT"/>
						</outline>
					<outline text="function returnError (err) {" created="Mon, 28 Feb 2022 14:38:48 GMT">
						<outline text="theRequest.httpReturn (503, &quot;text/plain&quot;, err.message);"/>
						<outline text="}" created="Mon, 28 Feb 2022 14:38:53 GMT"/>
						</outline>
					<outline text="function returnData (jstruct) {" created="Mon, 28 Feb 2022 14:38:48 GMT">
						<outline text="theRequest.httpReturn (200, &quot;application/javascript&quot;, utils.jsonStringify (jstruct));"/>
						<outline text="}" created="Mon, 28 Feb 2022 14:38:53 GMT"/>
						</outline>
					<outline text="function httpReturn (err, data) {" created="Mon, 28 Feb 2022 14:38:48 GMT">
						<outline text="if (err) {" created="Thu, 27 Jan 2022 16:15:45 GMT">
							<outline text="returnError (err);" created="Mon, 28 Feb 2022 14:42:42 GMT"/>
							<outline text="}" created="Thu, 27 Jan 2022 16:15:48 GMT"/>
							</outline>
						<outline text="else {" created="Thu, 27 Jan 2022 16:15:49 GMT">
							<outline text="returnData (data);" created="Thu, 27 Jan 2022 16:15:54 GMT"/>
							<outline text="}" created="Thu, 27 Jan 2022 16:15:51 GMT"/>
							</outline>
						<outline text="}" created="Mon, 28 Feb 2022 14:38:53 GMT"/>
						</outline>
					<outline text="function returnHtml (err, htmltext) {" created="Mon, 28 Feb 2022 14:38:48 GMT">
						<outline text="if (err) {" created="Thu, 27 Jan 2022 16:15:45 GMT">
							<outline text="returnError (err);" created="Mon, 28 Feb 2022 14:42:42 GMT"/>
							<outline text="}" created="Thu, 27 Jan 2022 16:15:48 GMT"/>
							</outline>
						<outline text="else {" created="Thu, 27 Jan 2022 16:15:49 GMT">
							<outline text="theRequest.httpReturn (200, &quot;text/html&quot;, htmltext);"/>
							<outline text="}" created="Thu, 27 Jan 2022 16:15:51 GMT"/>
							</outline>
						<outline text="}" created="Mon, 28 Feb 2022 14:38:53 GMT"/>
						</outline>
					<outline text="switch (theRequest.lowerpath) {">
						<outline text="case &quot;/connect&quot;: " created="Tue, 22 Aug 2023 15:28:53 GMT">
							<outline text="connectWithWordpress (returnHtml);" created="Tue, 22 Aug 2023 15:29:31 GMT"/>
							<outline text="return;" created="Tue, 22 Aug 2023 15:29:08 GMT"/>
							</outline>
						<outline text="case &quot;/callbackfromwordpress&quot;:" created="Tue, 22 Aug 2023 16:19:15 GMT">
							<outline text="http://localhost:1408/callbackFromWordpress?code=UhRCafYhq8&amp;state=1204" isComment="true" created="Tue, 22 Aug 2023 16:23:29 GMT"/>
							<outline text="if (params.state != config.myRandomNumber) {" created="Tue, 22 Aug 2023 21:46:52 GMT">
								<outline text="const message = &quot;Can't connect the user because the secret code doesn't match the one we sent.&quot;;" created="Tue, 22 Aug 2023 21:47:36 GMT"/>
								<outline text="returnError ({message});" created="Tue, 22 Aug 2023 21:47:21 GMT"/>
								<outline text="}" created="Tue, 22 Aug 2023 21:47:06 GMT"/>
								</outline>
							<outline text="else {" created="Tue, 22 Aug 2023 21:47:07 GMT">
								<outline text="requestTokenFromWordpress (params.code, function (err, tokenData) {" created="Tue, 22 Aug 2023 16:29:59 GMT">
									<outline text="if (err) {" created="Tue, 22 Aug 2023 16:41:24 GMT">
										<outline text="console.log (&quot;requestTokenFromWordpress: err.message == &quot; + err.message);"/>
										<outline text="returnError (err);" created="Tue, 22 Aug 2023 16:43:45 GMT"/>
										<outline text="}" created="Tue, 22 Aug 2023 16:41:32 GMT"/>
										</outline>
									<outline text="else {" created="Tue, 22 Aug 2023 16:41:38 GMT">
										<outline text="console.log (&quot;tokenData == &quot; + utils.jsonStringify (tokenData));" created="Tue, 22 Aug 2023 16:42:24 GMT"/>
										<outline text="returnData (tokenData);" isComment="true" created="Tue, 22 Aug 2023 16:44:34 GMT"/>
										<outline text="returnRedirect (config.urlMyHomePage + &quot;?accesstoken=&quot; + encodeURIComponent (tokenData.access_token));" created="Tue, 22 Aug 2023 22:14:02 GMT"/>
										<outline text="}" created="Tue, 22 Aug 2023 16:41:40 GMT"/>
										</outline>
									<outline text="});" created="Tue, 22 Aug 2023 16:30:09 GMT"/>
									</outline>
								<outline text="}" created="Tue, 22 Aug 2023 21:47:09 GMT"/>
								</outline>
							<outline text="return;" created="Tue, 22 Aug 2023 16:19:22 GMT"/>
							</outline>
						<outline text="case &quot;/now&quot;:">
							<outline text="theRequest.httpReturn (200, &quot;text/plain&quot;, new Date ().toUTCString ());"/>
							<outline text="return;"/>
							</outline>
						<outline text="default:">
							<outline text="theRequest.httpReturn (404, &quot;text/plain&quot;, &quot;Not found.&quot;);"/>
							<outline text="return;"/>
							</outline>
						<outline text="}"/>
						</outline>
					<outline text="}" created="Tue, 22 Aug 2023 21:49:55 GMT"/>
					</outline>
				<outline text="" created="Tue, 22 Aug 2023 15:29:46 GMT"/>
				<outline text="readConfig (&quot;config.json&quot;, config, function ()  {" created="Sat, 12 Aug 2023 23:07:16 GMT">
					<outline text="console.log (&quot;config == &quot; + utils.jsonStringify (config));" created="Mon, 14 Aug 2023 14:26:45 GMT"/>
					<outline text="davehttp.start (config, handleHttpRequest);"/>
					<outline text="});" created="Sat, 12 Aug 2023 23:07:41 GMT"/>
					</outline>
				</outline>
			<outline text="readme.md" created="Tue, 22 Aug 2023 21:40:09 GMT">
				<outline text="# wordpressIdentity">
					<outline text="Implements OAuth identity with wordpress.com for Node.js apps."/>
					</outline>
				</outline>
			<outline text="client/index.html" created="Tue, 22 Aug 2023 22:01:38 GMT">
				<outline text="&lt;html&gt;" created="Tue, 22 Aug 2023 22:01:47 GMT">
					<outline text="&lt;head&gt;" created="Tue, 22 Aug 2023 22:05:38 GMT">
						<outline text="&lt;%basicIncludes2%&gt;"/>
						<outline text="&lt;style&gt;" created="Wed, 11 Sep 2013 14:27:45 GMT" pgfnum="30095">
							<outline text="body {">
								<outline text="font-family: Ubuntu;"/>
								<outline text="font-size: 18px;"/>
								<outline text="background-color: whitesmoke;"/>
								<outline text="}"/>
								</outline>
							<outline text=".divPageBody {">
								<outline text="width: 60%;"/>
								<outline text="margin-top: 150px;"/>
								<outline text="margin-left: auto;"/>
								<outline text="margin-right: auto;"/>
								<outline text="margin-bottom: 400px;" created="Fri, 11 Jun 2021 12:29:37 GMT"/>
								<outline text="}"/>
								</outline>
							<outline text=".divPageBody image {" isComment="true" created="Tue, 22 Aug 2023 22:06:24 GMT">
								<outline text="text-align: center;" created="Tue, 22 Aug 2023 22:06:28 GMT"/>
								<outline text="}" created="Tue, 22 Aug 2023 22:06:34 GMT"/>
								</outline>
							<outline text="&lt;/style&gt;" created="Wed, 11 Sep 2013 14:30:17 GMT" pgfnum="30105"/>
							</outline>
						<outline text="&lt;script&gt;" created="Tue, 22 Aug 2023 22:07:49 GMT">
							<outline text="function connectWithWordpress () {" created="Tue, 22 Aug 2023 22:07:54 GMT">
								<outline text="location.href = &quot;http://localhost:1408/connect&quot;;" created="Tue, 22 Aug 2023 22:08:27 GMT"/>
								<outline text="}" created="Tue, 22 Aug 2023 22:07:57 GMT"/>
								</outline>
							<outline text="function startup () {" created="Tue, 22 Aug 2023 22:21:34 GMT">
								<outline text="console.log (&quot;startup&quot;);" created="Tue, 22 Aug 2023 22:22:11 GMT"/>
								<outline text="" created="Tue, 22 Aug 2023 22:25:53 GMT"/>
								<outline text="var tokendata = getURLParameter (tokendata);" isComment="true"/>
								<outline text="console.log (&quot;tokendata == &quot; + tokendata);" isComment="true" created="Tue, 22 Aug 2023 22:26:20 GMT"/>
								<outline text="}" created="Tue, 22 Aug 2023 22:21:40 GMT"/>
								</outline>
							<outline text="&lt;/script&gt;" created="Tue, 22 Aug 2023 22:07:51 GMT"/>
							</outline>
						<outline text="&lt;/head&gt;" created="Tue, 22 Aug 2023 22:05:45 GMT"/>
						</outline>
					<outline text="&lt;body&gt;" created="Tue, 22 Aug 2023 22:01:56 GMT">
						<outline text="&lt;div class=&quot;divPageBody&quot;&gt;" created="Tue, 22 Aug 2023 22:04:59 GMT">
							<outline text="&lt;center&gt;" created="Tue, 22 Aug 2023 22:06:48 GMT">
								<outline text="&lt;img alt=&quot;&quot; src=&quot;//s0.wp.com/i/wpcc-button.png&quot; width=&quot;231&quot; scale=&quot;0&quot; onclick=&quot;connectWithWordpress ()&quot;&gt;"/>
								<outline text="&lt;/center&gt;" created="Tue, 22 Aug 2023 22:06:50 GMT"/>
								</outline>
							<outline text="&lt;/div&gt;" created="Tue, 22 Aug 2023 22:06:06 GMT"/>
							</outline>
						<outline text="&lt;script&gt;">
							<outline text="$(document).ready (function () {">
								<outline text="startup ();" created="Wed, 30 Oct 2013 15:20:06 GMT" pgfnum="30656"/>
								<outline text="});"/>
								</outline>
							<outline text="&lt;/script&gt;"/>
							</outline>
						<outline text="&lt;/body&gt;" created="Tue, 22 Aug 2023 22:01:59 GMT"/>
						</outline>
					<outline text="&lt;/html&gt;" created="Tue, 22 Aug 2023 22:01:51 GMT"/>
					</outline>
				</outline>
			<outline text="config.json" isComment="true" created="Tue, 22 Aug 2023 14:23:58 GMT">
				<outline text="{" created="Tue, 22 Aug 2023 14:24:01 GMT">
					<outline text="}" created="Tue, 22 Aug 2023 14:24:02 GMT"/>
					</outline>
				</outline>
			</outline>
		<outline text="build script" created="Tue, 22 Aug 2023 14:28:04 GMT">
			<outline text="nodeEditorSuite.utilities.buildWpIdentity ()" created="Wed, 26 Jul 2023 16:00:18 GMT"/>
			</outline>
		</body>
	</opml>
